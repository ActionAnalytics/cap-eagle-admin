<div class="container" id="anchor-point">
  <div class="row">
    <main class="col-lg-8">
      <form (ngSubmit)="onSubmit()" #heroForm="ngForm">
        <section class="application-client card">
          <h4 class="card-header">Client</h4>
          <span>
            <label *ngIf="application.organization">{{application.organization.name}}</label>
            <button type="button" class="btn btn-primary float-right" (click)="selectClient()"><i class="material-icons">contacts</i>Select Client</button>
          </span>
        </section>

        <section class="application-description card">
          <h4 class="card-header">Description</h4>
          <textarea type="text"
            class="form-control"
            id="description"
            name="description"
            [(ngModel)]="application.description"
            required></textarea>
        </section>

        <section class="application-documents card">
          <h4 class="card-header">Documents</h4>
          <span>
            <input type="file"
              #fileInput
              (change)="fileChange($event)"
              multiple />
            <button type="button" class="btn btn-primary float-right" [disabled]="!fileList || fileList.length === 0" (click)="uploadFiles()"><i class="material-icons">file_upload</i>Upload Files</button>
          </span>

          <ul class="nv-list application-details--list">
            <li *ngFor="let file of applicationDocuments">
              <span class="name">{{file.displayName}}</span>
              <button type="button" class="btn btn-primary" (click)="api.downloadDocument(file)" title="Download this document"><i class="material-icons">file_download</i></button>
              <button type="button" class="btn btn-primary" (click)="api.openDocument(file)" title="Open this document"><i class="material-icons">open_in_new</i></button>
              <button type="button" *ngIf="!file.isPublished" class="btn btn-success" (click)="publishDocument(file)" title="Publish this document"><i class="material-icons">play_arrow</i></button>
              <button type="button" *ngIf="file.isPublished" class="btn btn-dark" (click)="unPublishDocument(file)" title="Un-publish this document"><i class="material-icons">pause</i></button>
              <button type="button" *ngIf="!file.isPublished" class="btn btn-danger" (click)="removeDocument(file)" title="Delete this document"><i class="material-icons">delete</i></button>
            </li>
          </ul>
        </section>

        <section class="application-legal_description card">
          <h4 class="card-header">Legal Description</h4>
          <textarea type="text"
            class="form-control"
            id="legalDescription"
            name="legalDescription"
            [(ngModel)]="application.legalDescription"
            required></textarea>
        </section>

        <section class="application-details card">
          <h4 class="card-header">Application Details</h4>
          <ul class="nv-list application-details--list">
            <li>
              <span class="name">Type</span>
              <select class="form-control"
                id="type"
                name="type"
                required
                (change)="typeChange(application.type)"
                [(ngModel)]="application.type"
                name="type">
                <option *ngFor="let type of types"
                  [value]="type">{{type}}</option>
              </select>
            </li>
            <li>
              <span class="name">Sub-Type</span>
              <select class="form-control"
                id="subtype"
                required
                name="subtype"
                [(ngModel)]="application.subtype"
                name="subtype">
                <option *ngFor="let subtype of subtypes[application.type]"
                  [value]="subtype">{{subtype}}</option>
              </select>
            </li>
            <li>
              <span class="name">Project Date</span>
              <input type="date"
                class="form-control"
                id="projectDate"
                name="projectData"
                [ngModel]="application.projectDate | date:'yyyy-MM-dd'"
                (ngModelChange)="application.projectDate = $event"
                required useValueAsDate>
            </li>
            <li>
              <span class="name">Status</span>
              <select class="form-control"
                id="status"
                required
                name="status"
                [(ngModel)]="application.status"
                name="status">
                <option *ngFor="let status of statuses"
                  [value]="status">{{status}}</option>
              </select>
            </li>
            <li>
              <span class="name">Region</span>
              <input type="text"
                class="form-control"
                id="region"
                name="region"
                [(ngModel)]="application.region"
                required>
            </li>
            <li>
              <span class="name">Location</span>
              <input type="text"
                class="form-control"
                id="location"
                name="location"
                [(ngModel)]="application.location"
                required>
              <span class="name">Area (hectares)</span>
              <input type="number"
                class="form-control"
                id="areaHectares"
                name="areaHectares"
                step="0.01"
                [(ngModel)]="application.areaHectares"
                required>
              <span class="name">Latitude</span>
              <input type="number"
                class="form-control"
                id="latitude"
                name="latitude"
                step="0.01"
                [(ngModel)]="application.latitude"
                required>
              <span class="name">Longitude</span>
              <input type="number"
                class="form-control"
                id="longitude"
                name="longitude"
                step="0.01"
                [(ngModel)]="application.longitude"
                required>
            </li>
            <li>
              <label for="purpose">Purpose:</label>
              <select class="form-control"
                id="purpose"
                required
                name="purpose"
                [(ngModel)]="application.purpose"
                (change)="purposeChange(application.purpose)"
                name="purpose">
                <option *ngFor="let purpose of purposes"
                  [value]="purpose">{{purpose}}</option>
              </select>
            </li>
            <li>
              <label for="purpose">Sub-Purpose:</label>
              <select class="form-control"
                id="subpurpose"
                name="subpurpose"
                required
                [(ngModel)]="application.subpurpose"
                name="subpurpose">
                <option *ngFor="let subpurpose of subpurposes[application.purpose]"
                  [value]="subpurpose">{{subpurpose}}</option>
              </select>
            </li>
            <!-- <li>
              <span class="value">{{application.latitude | coordinates:TransformationType.toDegree:Direction.Latitude}},
              <span class="name">Lat / Lon</span>
              <geo-coordinates [value]="10"></geo-coordinates>
              {{application.longitude | coordinates:TransformationType.toDegree:Direction.Longitude}}</span>
            </li> -->
            <li>
              <span class="name">Business Unit</span>
              <input type="text"
                class="form-control"
                id="businessUnit"
                name="businessUnit"
                [(ngModel)]="application.businessUnit"
                required>
            </li>
            <li>
              <div class="name">Crown Lands File(s):</div>
              <div *ngFor="let clf of application.cl_files">
                <span>
                  <div class="name col-4" (click)="removeCLFile(clf)">{{clf}}
                    <i class="material-icons">delete_forever</i>
                  </div>
                </span>
              </div>
              <div class="col-12">
                <input type="number"
                  class="name form-control col-4"
                  id="cl_files"
                  name="cl_files"
                  [(ngModel)]="clFile"
                  required>
                <button type="button pull-right" (click)="addCLFile()">Add CL File</button>
              </div>
            </li>
            <div *ngIf="application.internal" class="form-group">
              <section class="application-description card">
                <h4 class="card-header">Internal Notes</h4>
                <textarea type="text"
                  class="form-control"
                  id="internal.notes"
                  name="internal.notes"
                  [(ngModel)]="application.internal.notes"
                  required></textarea>
              </section>
            </div>

            <li>
              <button type="submit" class="btn btn-primary"><i class="material-icons">save</i>Save</button>
              <button type="button" *ngIf="!application.isPublished" class="btn btn-success" (click)="publishApplication(application)"><i class="material-icons">play_arrow</i>Publish</button>
              <button type="button" *ngIf="application.isPublished" class="btn btn-dark" (click)="unPublishApplication(application)"><i class="material-icons">pause</i>Un-Publish</button>
              <button type="button" *ngIf="!application.isPublished" class="btn btn-danger" (click)="deleteApplication(application)"><i class="material-icons">delete</i>Delete</button>
            </li>
          </ul>

          <div *ngIf="showMsg">
            <div *ngIf="error" class="alert alert-danger">{{status}}</div>
            <div *ngIf="!error" class="alert alert-success">{{status}}</div>
          </div>
        </section>
      </form>
    </main>
    <aside class="col-lg-4">
      
    </aside>
  </div>
</div>