<div class="search-container">
  <div class="container-fluid-padding">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item active" aria-current="page">Global Search</li>
      </ol>
    </nav>
    <h1>Search Environmental Assessment Projects</h1>
    <form #f="ngForm" class="search-form ui form" (ngSubmit)="onSubmit()">
      <label class="form-check-inline">
        <input class="form-check-input" type="radio" [checked]="this.terms.dataset === 'All'"
          (click)='handleRadioChange("All")'>All
      </label>
      <label class="form-check-inline">
        <input class="form-check-input" type="radio" [checked]="this.terms.dataset === 'Project'"
          (click)='handleRadioChange("Project")'>Projects
      </label>
      <label class="form-check-inline">
        <input class="form-check-input" type="radio" [checked]="this.terms.dataset === 'Document'"
          (click)='handleRadioChange("Document")'>Documents
      </label>
      <label class="form-check-inline">
        <input class="form-check-input" type="radio" [checked]="this.terms.dataset === 'Vc'"
          (click)='handleRadioChange("Vc")'>Valued Components
      </label>
      <div class="input-group main-search-field">
        <input class="form-control"
                type="text"
                name="keywordInput"
                placeholder="Enter keywords to search..."
                id="keywordInput"
                [(ngModel)]="terms.keywords"
                [disabled]="searching"
                autofocus />
        <div class="input-group-append">
          <!-- prevent searching if input is empty or we're already searching -->
          <button class="btn btn-primary" type="submit" [disabled]="!terms.keywords || searching">
            <i class="spinner rotating" [hidden]="!searching"></i>
            <span>{{searching ? 'Searching...' : 'Search'}}</span>
          </button>
        </div>
      </div>
      <div>
        <p class="search-result" *ngIf="ranSearch && !searching && count == 0">
          No result<span *ngIf="count != 1">s</span> found for "{{keywords}}"
        </p>
        <p class="search-result" *ngIf="ranSearch && !searching && count > 0">
          Showing {{ results.length }} of {{count}} result<span *ngIf="count != 1">s</span> for "{{keywords}}"
        </p>
      </div>
    </form>
  </div>
</div>

<div *ngIf="ranSearch && !searching && count != 0" class="page-controls text-center pt-3">
  <pagination-controls
    (pageChange)="updatePageNumber($event)"
    id="table-template-pagination"
    autoHide="true">
  </pagination-controls>
</div>

<div class="container-fluid-padding">
  <div class="search-results">
    <div *ngIf="count > 0">
      <!-- ALL -->
      <div *ngIf="this.terms.dataset === 'All'">
        <div *ngFor="let result of results | paginate: { id: 'table-template-pagination', itemsPerPage: pageSize, currentPage: currentPage, totalItems: count }">
          <div class="app-details" *ngIf="result._schemaName === 'Project'">
            <div class="card">
              <h2 class="card-header"><i class="material-icons">assignment</i>&nbsp;&nbsp;&nbsp;Project<span><a [routerLink]="['/p', result._id]" class="btn btn-primary float-right">View Project</a></span></h2>
              <div class="card-body">
                <h5 class="card-title">{{result.name}}</h5>
                <p class="card-text">{{result.type}} / {{result.sector}}</p>
                <p class="card-text">{{result.location}}</p>
              </div>
            </div>
          </div>
          <div class="app-details" *ngIf="result._schemaName === 'Document'">
            <div class="card">
              <h2 class="card-header"><i class="material-icons">picture_as_pdf</i>&nbsp;&nbsp;&nbsp;Document<span *ngIf="result.project"> ({{result.project.name}}) <a *ngIf="result.project" [routerLink]="['/p', result.project._id]" class="btn btn-primary float-right">View Project</a></span></h2>
              <div class="card-body">
                  <h5 class="card-title">{{result.displayName}}</h5>
                <p class="card-text">{{result.datePosted | date:'medium'}}</p>
                <a href="#" class="btn btn-primary">Download Document</a>
              </div>
            </div>
          </div>
          <div class="app-details" *ngIf="result._schemaName === 'Vc'">
            <div class="card">
              <h2 class="card-header"><i class="material-icons">switch_camera</i>&nbsp;&nbsp;&nbsp;Valued Component</h2>
              <div class="card-body">
                <h5 class="card-title">{{result.name}}</h5>
                <p class="card-text">{{result.description}}</p>
                <a [routerLink]="['/p', result._id]" class="btn btn-primary float-right">View VC</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- END ALL -->

      <!-- NOT ALL -->
      <div *ngIf="this.terms.dataset === 'Document'">
        <div class="app-details" *ngFor="let result of results | paginate: { id: 'table-template-pagination', itemsPerPage: pageSize, currentPage: currentPage, totalItems: count }">
          <div class="card">
              <h2 class="card-header"><i class="material-icons">picture_as_pdf</i>&nbsp;&nbsp;&nbsp;Document</h2>
            <div class="card-body">
              <h5 class="card-title">{{result.displayName}}</h5>
              <p class="card-text">{{result.datePosted | date:'medium'}}</p>
              <a [routerLink]="['/p', result.project]" class="btn btn-primary float-right">View Project</a>
              <a href="#" class="btn btn-primary">Download Document</a>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="this.terms.dataset === 'Project'">
        <div class="app-details" *ngFor="let result of results | paginate: { id: 'table-template-pagination', itemsPerPage: pageSize, currentPage: currentPage, totalItems: count }">
          <div class="card">
              <h2 class="card-header"><i class="material-icons">assignment</i>&nbsp;&nbsp;&nbsp;Project</h2>
              <div class="card-body">
                <h5 class="card-title">{{result.name}}</h5>
                <p class="card-text">{{result.type}} / {{result.sector}}</p>
                <p class="card-text">{{result.location}}</p>
                <a [routerLink]="['/p', result._id]" class="btn btn-primary float-right">View Project</a>
              </div>
            </div>
        </div>
      </div>
      <div *ngIf="this.terms.dataset === 'Vc'">
        <div class="app-details" *ngFor="let result of results | paginate: { id: 'table-template-pagination', itemsPerPage: pageSize, currentPage: currentPage, totalItems: count }">
          <div class="card">
              <h2 class="card-header"><i class="material-icons">switch_camera</i>&nbsp;&nbsp;&nbsp;Valued Component</h2>
            <div class="card-body">
              <h5 class="card-title">{{result.name}}</h5>
              <p class="card-text">{{result.description}}</p>
              <a [routerLink]="['/p', result.project]" class="btn btn-primary float-right">View VC</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="ranSearch && !searching && count != 0" class="page-controls text-center pt-3">
  <pagination-controls
    (pageChange)="updatePageNumber($event)"
    id="table-template-pagination"
    autoHide="true">
  </pagination-controls>
</div>